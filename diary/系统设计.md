# 系统设计

## 前言

一个好的系统必定是经过用心设计的。

## 多模块

每一个新的项目必有的模块，**用户模块**，用户的信息、登录、注册以及权限。

所以考虑，使用 Maven 构建多模块项目，高内聚低耦合。

权限设计因为往往和业务有紧密联系，所以独立成一个依赖。

## 数据库设计

对于每一张表，必有三字段，id , gmt_create , gmt_modified。

> 其中 id 必为主键，类型为 unsigned bigint 、单表时自增、步长为 1。 gmt _ create ,
gmt _ modified 的类型均为 date _ time 类型

## 用户设计

多种认证，第三方登录成了现在用户认证的常见方式，所以将用户的信息与认证信息独立。

每个认证表中都有一个指向用户信息表主键的外键,不包含用户的信息。

用户名、邮箱、手机、密码之间的关系一一对应，所以放在一张表中，不会出现多表密码不同步；而且前三字段不可全为空。

第三方认证，也独立成一张表，添加一个字段，以区分不同第三方的认证。

## 权限设计

### 将权限设计成表字段

![](https://cdn.rawgit.com/f12998765/wiki/master/.img/user.png)

每个用户有个权限属性，使用二进制编码存储，还有一个新的权限表，首先在加载项目时，建立一个全局的权限队列，与二进制编码运算判断

### RBAC

### Apache Shiro

[Apache Shiro](https://shiro.apache.org/)

## 认证授权设计

JWT 用户退出 盗用Cookie

## 通知设计

消息提醒 邮件发送

## 参考
- [廖雪峰-设计一个可扩展的用户登录系统](http://www.liaoxuefeng.com/article/001437480923144e567335658cc4015b38a595bb006aa51000)
