# 递归方程求解
## 主定理

```math
T\left( n\right) =aT\left( \dfrac {n} {b}\right) +f\left( n\right)
```

```math
T(n)=\begin{cases}
 \Theta (n^{log_b a})& \exists \varepsilon >0,f(n)=O(n^{log_b a -\varepsilon }) \\
 \Theta (n^{log_b a}lgn)& \exists k \geq 0,f(n)=\Theta (n^{log_b a}) \\
 \Theta (f(n))& \exists \varepsilon >0,f(n)=\Omega (n^{log_b a +\varepsilon }) \text{ and }\exists c<1 , n \text{ large enough},af(\frac{n}{b})\leq cf(n)
\end{cases}
```

## 主定理的衍生
### 衍生1
```
\begin{align*}  
T\left( n\right) &=aT\left( \dfrac{n}{b}\right) +\Theta( n^d)
\end{align*}
```

```
T(n)=\begin{cases}
 \Theta (n^{log_b a}) &\text{ if }a >b^d\\
 \Theta (n^{log_b a}lgn) &\text{ if }a =b^d\\
 \Theta (n^d) &\text{ if }a <b^d
\end{cases}
```
### 衍生2
```
\begin{align*}  
T\left( n\right) &=aT\left( \dfrac{n}{b}\right) +c
\end{align*}
```

```
T(n)=\begin{cases}
 \Theta (n^{log_b a}) &\text{ if }a \neq 1\\
 \Theta (lgn) &\text{ if }a =1
\end{cases}
```

## 迭代法

假设求解如下递归方程：
```
\begin{align*}  
&t_n =t_{n-1} +n & (n>1) \\
&t_1 = 1&  
\end{align*}
```
列举
```
\begin{align*}  
&t_n =t_{n-1} +n \\
&t_{n-1} =t_{n-2} +n-1 \\
&t_{n-2} =t_{n-3} +n-2\\
&\vdots \\
&t_2 =t_1+2\\
&t_1 = 1&  
\end{align*}
```
将左右累加，用右边消去左边，最终得到 t(n)
```
\begin{align*}  
t_n &=n +{n-1}+{n-2}+\cdots +2+1\\
&= \sum_{i=1}^{n}i\\
&=\frac{n(n+1)}{2}
\end{align*}

```
## 特征方程

具体查看 《Foundations Of Algorithms》附录B。

### 齐次线性递归方程
如下形式的递归方程称为常数系齐次线性递归方程

```
\begin{align*}  
&a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k}=0 &k \text{ 和 } a_i \text{都是常数}
\end{align*}
```
线性指每一项 t 都只出现在一次幂中

齐次指这个多项式等于0

**特征方程**
```
\begin{align*}  
&a_0r^k+a_1r^{k-1}+\cdots +a_kr^0=0
\end{align*}
```

将特征方程求解，得出 k 个不同的解，r1、r2、r3、...、rn，则该递归方程的解为
```
\begin{align*}  
t_n &=c_1r_1^n+c_2r_2^n+\cdots +c_kr_k^n \\
&=\sum_{i=1}^{k}c_ir_i^n
\end{align*}
```
但是要求特征方程的所有 k 个根都不相同，**不允许**出现如下情况：
```
\begin{align*}  
(r-1)(r-2)^3=0
\end{align*}
```
对于多重根的情况，需要加上一个多项式，多个多重根需要加上多个和式，例如 r_x 是特征方程的m重根：
```
\begin{align*}  
&t_n =\sum_{i=1}^{k}c_ir_i^n +\sum_{j=1}^{m-1}n^jr_x^n+\cdots  & r_x \text{是m重根}
\end{align*}
```
### 非齐次线性递归方程
如下形式的递归方程称为常数系非齐次线性递归方程

```
\begin{align*}  
&a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k}=f(n) &k \text{ 和 } a_i \text{都是常数}
\end{align*}
```
解决如上方程还未发现通用的解法

下面看一个特例的解法
```
\begin{align*}  
&a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k}=b^np(n) &b \text{为常数，}  p(n) \text{ 为n的多项式}
\end{align*}
```
**当p(n)=1时**，有如下解法
```
\begin{align*}  
& a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k}=b^n & (1)\\
& a_0t_{n-1}+a_1t_{n-2}+\cdots +a_kt_{n-k-1}=b^{n-1} &(2) \\
& \frac{a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k}}{b}=b^{n-1} &(3)\\
& (a_0t_{n-1}+a_1t_{n-2}+\cdots +a_kt_{n-k-1})-(\frac{a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k}}{b})=0 &(4)\\
& -a_0t_n+(a_0-\frac{a_1}{b})t_{n-1}+\cdots +(a_{k-1}-\frac{a_{k}}{b})t_{n-k}+a_kt_{n-k-1}=0 &(5)
\end{align*}
```
将 t_{n-1} 带入式子(1)中，得到(2)
将 (1) 左右同除以 b ,得到 (3)
用 (2) 减去 (3) 得到 (4) 化简后得到 (5)
式子 (5) 是一个常数系齐次线性递归方程

**特例的普通解法**
将式子进行如下转换
```
\begin{align*}  
a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k}=b^np(n) \Rightarrow (a_0t_n+a_1t_{n-1}+\cdots +a_kt_{n-k})(r-b)^{d+1}=0
\end{align*}
```
> d 是多项式p(n)的最高次幂

所以接下来用线性齐次的解法就可以了。

### 变量变换

对于如下形式的递归方程，无法直接用特征方程来解决，所以需要装换一下。或者使用主定理更容易一点。
```
\begin{align*}  
&T(n)=aT(\frac{n}{b})+f(n) & n>1,\text{且为b的幂}
\end{align*}
```
首先设 n=b^k ,那么 k =log_b n，用 b^k 代替 n 在 T(n) 中。
```
\begin{align*}  
&T(n)=aT(\frac{n}{b})+f(n) \Rightarrow T(b^k)=aT(\frac{b^k}{b})+f(b^k)=aT(b^{k-1})+f(b^k)
\end{align*}
```
然后设
```
\begin{align*}  
t_k=T(2^k)
\end{align*}
```

得到新的递归方程，接下来就能用非齐次线性方程的解法来解决
```
\begin{align*}  
T(b^k)=aT(b^{k-1})+f(b^k) \Rightarrow t_k-at_{k-1}=f(b^k)
\end{align*}
```
